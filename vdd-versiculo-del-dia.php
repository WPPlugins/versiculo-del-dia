<?php/*Plugin Name: Versiculo del diaPlugin URI: https://wordpress.org/plugins/versiculo-del-dia/Description: Muestra el versículo del día, llevando la palabra de Dios todos los dias en tu Sitio WebVersion: 1.0Author: Bibliatodo.comAuthor URI: https://www.bibliatodo.comLicense: GPL2  Copyright 2016  BibliaTodo.com  (email : bibliatodo1@gmail.com)    This program is free software; you can redistribute it and/or modify    it under the terms of the GNU General Public License, version 2, as     published by the Free Software Foundation.    This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.    You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA*/function vdd_agregar_css_versiculo_del_dia() {	wp_register_style( 'prefix-style', plugins_url('vdd-versiculo-del-dia.css', __FILE__) );	wp_enqueue_style( 'prefix-style' );}add_action( 'wp_enqueue_scripts', 'vdd_agregar_css_versiculo_del_dia' );function vdd_versiculo_funcion_del_dia($showlink, $language='es') {	$languageAdd = '';	$languageUrl = '';	if($language == '')	{		$languageAdd = '';	}	else if($language == 'en')	{		$languageAdd = '_en';		$languageUrl = ''; /* aqui va el parametro para el idioma ingles */	}	else	{		$language = 'es';	}	$position = rand(0, 200);	$vdd_versiculo_dia = get_option('vdd_versiculo_dia_' . $position . $languageAdd);	$vdd_versiculo_dia_lastAttempt = get_option('vdd_versiculo_dia_LastAttempt' . $languageAdd);		if($vdd_versiculo_dia == "" && $vdd_versiculo_dia_lastAttempt < (date('U') - 3600))	{		$url = 'https://www.bibliatodo.com/recursos/plugin_versodiario?=' . $language . '&position=' . $position . '&url=' . $_SERVER['HTTP_HOST'] . '&type=random2_1';		$result = wp_remote_get($url);		if(!is_wp_error($result)) 		{			$vdd_versiculo_dia = str_replace(',', '&#44;', $result['body']);			update_option('vdd_versiculo_dia_' . $position . $languageAdd, $vdd_versiculo_dia);		}		else		{			update_option('vdd_versiculo_dia_LastAttempt' . $languageAdd, date('U'));		}	}	if($vdd_versiculo_dia == "")	{		if($language == "kjv")		{			$bibleVerseOfTheDay_bibleVerse = '<div class="Porque de tal manera amó Dios al mundo, que ha dado a su Hijo unigénito, para que todo aquel que en él cree, no se pierda, mas tenga vida eterna.</div><div class="vdd_versiculo_dia_textodelabiblia"><a href="https://www.bibliatodo.com/biblia/Reina-valera-1960/juan-3-16" target="_blank">Juan 3:16</a></div>';		}	}			if($showlink == 'true' || $showlink == '1')	{		$html = $vdd_versiculo_dia . '<div class="vdd_agregarversodiario"><a href="https://www.bibliatodo.com/recursos' . $languageUrl . '" target="_blank">Agrega el Versiculo del dia a tu Sitio Web</div>';	}	else	{		$html = $vdd_versiculo_dia;	}		return $html;}add_shortcode('vdd_versiculo_dia', 'vdd_versiculo_funcion_del_dia'); add_shortcode('vdd_versiculo_dia_kjv', 'vdd_versiculo_dia_kjv '); function vdd_versiculo_dia_kjv() {	return vdd_versiculo_dia('0', 'kjv');}class vdd_versiculo_del_dia_Widget extends WP_Widget{  function form($instance)  {    $instance = wp_parse_args( (array) $instance, array( 'title' => 'Bible verse of the day', 'showlink' => '1', 'language' => '' ) );    $title = $instance['title'];	$showlink = $instance['showlink'];	$language = $instance['language'];	?><?php  }   function update($new_instance, $old_instance)  {    $instance = $old_instance;    $instance['title'] = $new_instance['title'];	if($new_instance['showlink'] == '1')	{		$instance['showlink'] = '1';	}	else	{		$instance['showlink'] = '0';	}		if($new_instance['language'] == '')	{		$instance['language'] = 'es';	}	else	{		$instance['language'] = $new_instance['language'];	}    return $instance;  }   function widget($args, $instance)  {    extract($args, EXTR_SKIP);     echo $before_widget;    $title = empty($instance['title']) ? ' ' : apply_filters('widget_title', $instance['title']);     if (!empty($title))      echo $before_title . $title . $after_title;;  	$showlink = $instance['showlink'];	if($showlink == '')	{		$showlink = '1';	}		$language = $instance['language'];	if($language == '')	{		$language = 'es';	}	    echo ddlb_bible_verse_of_the_day($showlink, $language);     echo $after_widget;  } }class vdd_versiculo_diaWidget extends WP_Widget{  function __construct()   {	parent::__construct('vdd_versiculo_diaWidget', __('Versiculo del dia', 'vdd_versiculo_dia' ), array ('description' => __( 'Este plugins muestra un versiculo diario de la Santa Palabra de Dios, la biblia,  por Bibliatodo.com', 'vdd_versiculo_dia')));  }   function form($instance)  {    $instance = wp_parse_args( (array) $instance, array( 'title' => 'Versiculo del dia', 'showlink' => '1', 'language' => 'es' ) );    $title = $instance['title'];	$showlink = $instance['showlink'];	$language = $instance['language'];	?>  <p><label for="<?php echo $this->get_field_id('title'); ?>">Title: <input class="vdd_widefat" id="<?php echo $this->get_field_id('title'); ?>" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo esc_attr($title); ?>" /></label></p>  <p><select id="<?php echo $this->get_field_id('language'); ?>" name="<?php echo $this->get_field_name('language'); ?>">	<option value="en" <?php _e($language == '' || $language == 'es' ? 'selected' : ''); ?>>Español</option>	<!--  <option value="en" <?php _e($language == 'en' ? 'selected' : ''); ?>>Ingles</option>  -->  </select></p>  <p><input id="<?php echo $this->get_field_id('showlink'); ?>" name="<?php echo $this->get_field_name('showlink'); ?>" type="checkbox" value="1" <?php checked( '1', $showlink ); ?>/><label for="<?php echo $this->get_field_id('showlink'); ?>"><?php _e('&nbsp;Show link to BibliaTodo.com (thank you!)'); ?></label></p><?php  }   function update($new_instance, $old_instance)  {    $instance = $old_instance;    $instance['title'] = $new_instance['title'];	if($new_instance['showlink'] == '1')	{		$instance['showlink'] = '1';	}	else	{		$instance['showlink'] = '0';	}	if($new_instance['language'] == '')	{		$instance['language'] = 'en';	}	else	{		$instance['language'] = $new_instance['language'];	}    return $instance;  }   function widget($args, $instance)  {    extract($args, EXTR_SKIP);     echo $before_widget;    $title = empty($instance['title']) ? ' ' : apply_filters('widget_title', $instance['title']);     if (!empty($title))      echo $before_title . $title . $after_title;;  	$showlink = $instance['showlink'];	if($showlink == '')	{		$showlink = '1';	}		$language = $instance['language'];	if($language == '')	{		$language = 'en';	}	    echo vdd_versiculo_funcion_del_dia($showlink, $language);     echo $after_widget;  }}add_action( 'widgets_init', create_function('', 'return register_widget("vdd_versiculo_diaWidget");') );?>